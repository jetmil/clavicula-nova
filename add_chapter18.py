#!/usr/bin/env python3
"""Add Chapter 18: Тайминг операций"""

import json

chapter18_content = """# Тайминг операций

Время в магии — не просто удобство. Это фундаментальный фактор, определяющий силу и характер работы. Операция, проведённая в правильное время, многократно эффективнее той же операции в неподходящий момент.

## Планетарные дни недели

### Система

Каждый день недели управляется одной из семи классических планет:

**Воскресенье — Солнце.** День света, успеха, славы, здоровья. Работы: карьера, признание, жизненная сила, связь с высшими силами.

**Понедельник — Луна.** День изменений, снов, интуиции. Работы: дивинация, работа со снами, женские дела, путешествия по воде.

**Вторник — Марс.** День силы, конфликта, энергии. Работы: защита, атака, хирургия, физическая сила, победа над врагами.

**Среда — Меркурий.** День коммуникации, интеллекта, торговли. Работы: учёба, переговоры, письмо, путешествия, обман (осторожно).

**Четверг — Юпитер.** День расширения, удачи, закона. Работы: деньги, бизнес, юридические дела, религиозные практики.

**Пятница — Венера.** День любви, красоты, гармонии. Работы: романтика, искусство, примирение, удовольствия.

**Суббота — Сатурн.** День ограничений, окончаний, глубины. Работы: защита, связывание, работа с мёртвыми, кармические вопросы.

### Выбор дня

Соотнеси цель операции с планетой и выбери соответствующий день:

- Нужны деньги? Четверг (Юпитер) или воскресенье (Солнце).
- Нужна защита? Вторник (Марс) или суббота (Сатурн).
- Нужна любовь? Пятница (Венера).
- Нужно знание? Среда (Меркурий).

## Планетарные часы

### Принцип

День и ночь делятся на 12 планетарных часов каждый. Длина часа неодинакова: летом дневные часы длиннее, ночные короче; зимой — наоборот.

Первый дневной час начинается с восходом солнца и управляется планетой дня. Затем планеты чередуются в халдейском порядке:

Сатурн → Юпитер → Марс → Солнце → Венера → Меркурий → Луна → снова Сатурн...

### Расчёт

**Шаг 1:** Узнай время восхода и заката для твоего местоположения и даты.

**Шаг 2:** Вычисли длину дня (от восхода до заката) в минутах. Раздели на 12 — это длина дневного планетарного часа.

**Шаг 3:** Вычисли длину ночи (от заката до следующего восхода). Раздели на 12 — длина ночного планетарного часа.

**Шаг 4:** Первый дневной час — планета дня. Далее чередуй по халдейскому порядку.

**Пример:** Воскресенье, восход 6:00, закат 18:00.
- День = 12 часов = 720 минут. Планетарный час = 60 минут.
- Первый час (6:00-7:00) — Солнце
- Второй час (7:00-8:00) — Венера
- Третий час (8:00-9:00) — Меркурий
- И так далее...

### Таблица планетарных часов

| Час | Вс | Пн | Вт | Ср | Чт | Пт | Сб |
|-----|----|----|----|----|----|----|-----|
| 1 | ☉ | ☽ | ♂ | ☿ | ♃ | ♀ | ♄ |
| 2 | ♀ | ♄ | ☉ | ☽ | ♂ | ☿ | ♃ |
| 3 | ☿ | ♃ | ♀ | ♄ | ☉ | ☽ | ♂ |
| 4 | ☽ | ♂ | ☿ | ♃ | ♀ | ♄ | ☉ |
| 5 | ♄ | ☉ | ☽ | ♂ | ☿ | ♃ | ♀ |
| 6 | ♃ | ♀ | ♄ | ☉ | ☽ | ♂ | ☿ |
| 7 | ♂ | ☿ | ♃ | ♀ | ♄ | ☉ | ☽ |
| 8 | ☉ | ☽ | ♂ | ☿ | ♃ | ♀ | ♄ |
| 9 | ♀ | ♄ | ☉ | ☽ | ♂ | ☿ | ♃ |
| 10 | ☿ | ♃ | ♀ | ♄ | ☉ | ☽ | ♂ |
| 11 | ☽ | ♂ | ☿ | ♃ | ♀ | ♄ | ☉ |
| 12 | ♄ | ☉ | ☽ | ♂ | ☿ | ♃ | ♀ |

(Таблица для дневных часов; ночные продолжают последовательность)

### Оптимальное сочетание

Идеал: день планеты + час планеты.
- Воскресенье, 1-й или 8-й час — максимальная солнечная сила.
- Четверг, 1-й или 8-й час — максимальная юпитерианская сила.

Приемлемо: день планеты + час совместимой планеты.
- Пятница, час Юпитера — любовь (Венера) с расширением (Юпитер).

Нежелательно: конфликтующие планеты.
- Марс и Венера — противоположности.
- Сатурн и Юпитер — ограничение vs расширение.

## Фазы Луны

### Значение фаз

**Новолуние (тёмная Луна).** Луна не видна. Время для:
- Работы с хтоническими силами
- Операций сокрытия и невидимости
- Начала тайных дел
- Некромантии

**Растущая Луна.** От новолуния до полнолуния. Время для:
- Привлечения (деньги, любовь, удача)
- Роста и развития
- Начала проектов
- Увеличения силы

**Полнолуние.** Максимальная лунная сила. Время для:
- Мощных операций любого типа
- Кульминации работ
- Инвокаций
- Работы с лунными духами

**Убывающая Луна.** От полнолуния до новолуния. Время для:
- Изгнания и очищения
- Окончания и завершения
- Уменьшения (долгов, болезней, врагов)
- Защиты через отталкивание

### Лунные дни

Некоторые традиции работают с лунными днями (от новолуния):
- 1-й день — новые начинания
- 7-й день — половина к полнолунию, подведение итогов
- 14-15-й дни — полнолуние
- 28-29-й дни — тёмная Луна, завершение цикла

### Луна в знаках

Луна проходит зодиак за ~28 дней, проводя ~2.5 дня в каждом знаке.

**Огненные знаки (Овен, Лев, Стрелец):** Энергия, инициатива, творчество. Хорошо для начинаний.

**Земные знаки (Телец, Дева, Козерог):** Стабильность, материальные дела, практическая магия.

**Воздушные знаки (Близнецы, Весы, Водолей):** Коммуникация, интеллект, социальные дела.

**Водные знаки (Рак, Скорпион, Рыбы):** Эмоции, интуиция, психические работы, магия снов.

## Солнечный цикл

### Четыре точки года

**Весеннее равноденствие (~21 марта).** День равен ночи. Баланс, новое начало, Остара. Работы: новые проекты, обновление, весенняя магия.

**Летнее солнцестояние (~21 июня).** Самый длинный день. Пик солнечной силы, Лита. Работы: кульминация проектов, максимальная мощность, солнечные духи.

**Осеннее равноденствие (~21 сентября).** Снова баланс, сбор урожая, Мабон. Работы: завершение, благодарность, подведение итогов.

**Зимнее солнцестояние (~21 декабря).** Самая длинная ночь. Возрождение света, Йоль. Работы: трансформация, работа с тенью, новый цикл.

### Восьмеричное колесо

Между солнцестояниями и равноденствиями — четыре дополнительных праздника:

- **Имболк** (~2 февраля) — первые признаки весны
- **Белтейн** (~1 мая) — расцвет
- **Лугнасад/Ламмас** (~1 августа) — первый урожай
- **Самайн** (~31 октября) — граница с миром мёртвых

Каждая из этих точек имеет свою магическую силу и подходит для определённых операций.

## Когда НЕ работать

### Запретные времена

**Void of Course Moon.** Луна между аспектами, "пустая". Операции, начатые в это время, не дают результата. Проверяй эфемериды.

**Ретроградный Меркурий.** Три раза в год по ~3 недели. Не начинай новых проектов, не подписывай контрактов, не проводи операций коммуникации.

**Затмения.** Солнечные и лунные затмения — мощное, но нестабильное время. Только для опытных и только для особых целей.

**Личное истощение.** Болезнь, сильный стресс, недосып. Время неподходящее независимо от планет.

### Неблагоприятные сочетания

- Марсианская работа в день Венеры
- Венерианская работа в день Марса
- Любые операции роста при убывающей Луне
- Операции изгнания при растущей Луне

## Практический подход

### Идеал vs реальность

Идеал: день планеты + час планеты + правильная фаза Луны + Луна в подходящем знаке + благоприятный аспект + хорошее личное состояние.

Реальность: такое сочетание случается редко. Как быть?

**Приоритеты:**
1. Личное состояние — обязательно
2. Фаза Луны — важно
3. День планеты — важно
4. Час планеты — желательно
5. Остальное — бонус

**Компенсация:** Если время неидеально — компенсируй силой намерения, качеством подготовки, мощностью ритуала.

### Спонтанная работа

Иногда нужно действовать немедленно. Тогда:
- Определи текущий планетарный час
- Адаптируй работу под текущие условия
- Усиль защиту и намерение
- Прими, что результат может быть слабее

---

Время — не тюрьма для мага, а союзник. Знание циклов позволяет плыть по течению, а не против него. Работа с правильным таймингом требует меньше усилий и даёт больший результат.

Веди календарь. Планируй операции заранее. Но будь готов адаптироваться.
"""

# Read existing book
with open('book.json', 'r', encoding='utf-8') as f:
    book = json.load(f)

# Add chapter 18
book['chapters'].append({
    'id': 18,
    'book': 'III',
    'title': 'Тайминг операций',
    'content': chapter18_content
})

# Save
with open('book.json', 'w', encoding='utf-8') as f:
    json.dump(book, f, ensure_ascii=False, indent=2)

# Calculate total words
total_words = sum(len(ch['content'].split()) for ch in book['chapters'])

print(f"Added Chapter 18: Тайминг операций")
print(f"Words in chapter: {len(chapter18_content.split())}")
print(f"Total chapters: {len(book['chapters'])}")
print(f"Total words: {total_words}")
